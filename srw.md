





[^1]: 请注意，此讨论出现在有关SRE的书中，其中一些讨论特定于软件服务操作，而不是IT操作。

[^2]: 玛丽·波彭迪克（Mary Poppendieck）在这方面有一篇出色的文章，名为“ [成本中心陷阱]（http://bit.ly/2LRFkHt）”。这种方法失败的另一种方式是，当一场非常大且不可能的灾难完全抵消了您采用低等级运营模式所节省的成本时（参见[2017年5月英国航空公司的停运]（https: //ind.d pn / 2LNQflE））。

[^3]: 当然，还有许多其他潜在的反应。例如，ITIL®是另一种IT管理方法，倡导更好的标准化。

[^4]: 还要注意，因为这是一个复杂的世界，所以也存在[正效应]（http://bit.ly/2JaOddH）到[分区]（http://bit.ly/2L9Mw0s），孤岛等，但是在运营领域，不利因素似乎尤其严重。

[^5]: 请参阅[* https: //en.wikipedia.org/wiki/Normal_Accidents*]（https://en.wikipedia.org/wiki/Normal_Accidents）。

[^6]: 较高风险的更改或无法通过自动方式确认的更改，显然应该由人类审核，即使不是由他们实施的。

    **DevOps的背景**

[^7]: Google的SRE历史来自前身的团队，该团队更注重运营，Ben从工程的角度提供了解决问题的动力。

[^8]: 这在很多方面都是用词不当，也许最根本的原因是您不能仅仅雇用一些人，称他们为“ DevOps工程师”，并立即期望收益。您必须接受改变工作方式以受益的全部理念。正如[Andrew Clay Shafer所说]（http://bit.ly/2sy7UVI）一样，“人们出售DevOps，但您买不到。”而且，正如Seth Vargo在[“ DevOps的十大神话”]（http://bit.ly/2HcHmP1）中指出的那样，您不能“雇用DevOp来修复您的组织”。

[^9]: 服务水平目标是特定指标性能的目标（例如，有99.9％的时间可用）。

    **SRE背景**

[^10]: 当然，不是每个团队都做所有事情，但是这些是SRE工作的最常见标题。

[^11]: 如果您将其视为分层堆栈，请执行分层冲突。

[^12]: 实际上，有任何内容*的生产准备情况审查； SRE不仅会从一开始就提供车载服务。

[^13]: 服务通常被定义为运行以执行某些业务需求的软件，通常具有可用性约束。

    **比较和对比**

[^14]: 在Google内部，这个问题已得到解决，服务始终会更改状态，配置，所有权，方向等。在一定程度上，Google的SRE曾是“抗争是必要的”论点的受益者，该论点过去曾被抗争并赢得过多次胜利。但是，正如威廉·吉布森（William Gibson）可能说的那样，并不是完全[均匀分布]（http://bit.ly/2J1qnFf）。

[^15]: 请参阅[* https: //devops-research.com/research.html*]（https://devops-research.com/research.html）上的相关研究。

[^16]: 请参阅[* http: //en.wikipedia.org/wiki/Goodhart%27s_law*]（http://en.wikipedia.org/wiki/Goodhart%27s_law）和[* https: //skybrary.aero/bookshelf/ books / 2336.pdf *]（https://skybrary.aero/bookshelf/books/2336.pdf）。

    **组织环境与成功采用者的培养**

[^17]: 参见例如[* https: //codeascraft.com/2012/05/22/blameless-postmortems/*]（https://codeascraft.com/2012/05/22/blameless-postmortems/）。

[^18]: 在具有发达文化的组织中。早期公司可能没有建立奖励这些工作角色的方法。

[^19]: 确实，可以说，除非您外包操作，否则这是您的*唯一*选择。

[^20]: 有关如何在不同上下文中应用SRE原则的讨论，请参见第20章。

    **组织环境与成功采用者的培养**

[^21]: 换句话说，简单地淘汰一组DevOps或SRE，而无需改变他们的组织位置，导致在无法实现预期的改进时不可避免地使团队蒙羞。

[^22]: 关于术语的注释: 在本章中，我们始终使用“可靠性”一词来谈论服务在其所有SLI方面的性能。这可能表示许多情况，例如可用性或延迟。

[^23]: 这不同于*服务水平协议*（SLA），后者是一种商业合同，当您的用户非常不满意时，您必须以某种方式对其进行赔偿。

[^24]: 有关将依赖项分解为服务可靠性的更多详细信息，请参阅Ben Treynor，Mike Dahlin，Vivek Rau和Betsy Beyer，“服务可用性的微积分”，* ACM队列* 15，否。 2（2017），[* https: // ** queue.acm.org / detail.cfm？id = 3096459 *]（https://queue.acm.org/detail.cfm?id=3096459）。

    **入门**

[^25]: 如果您在一个日历周期（例如一个季度）内衡量SLO，那么如果它基于流量等不可预测的指标，那么您可能不知道该季度末的预算将是多少。有关报告期间的更多讨论，请参见第29页“选择合适的时间窗口”。

    **入门**

[^26]: 免责声明: 您将来可能会遇到更艰巨的任务。

    **获得利益相关者协议**

[^27]: * Recall *是SLI捕获的重大影响用户事件的比例。* Precision *是SLI捕获的严重影响用户的事件的比例。

[^28]: 这里值得重申的是，错误预算是用户满意度的近似值。每30天四小时的中断可能会导致不满意的用户少于每30天四次单独的一小时中断，这反过来会导致不满意的用户少于0.5％的恒定错误率，但是我们的错误预算将相同。这些阈值因服务而异。

    **使用SLO和错误预算进行决策**

[^29]: 如果依赖项不可用，则意味着依赖也很关键。

[^30]: 但这是另一本书的故事---在[* http: //bit.ly/2spqgcl*]（http://bit.ly/2spqgcl）上查看更多详细信息。

    **Evernote的SLO故事**

[^31]: 培训选择范围从一个小时的入门到半天的工作坊，再到与成熟的SRE团队进行为期四周的沉浸式学习，并附有毕业典礼和FiRE徽章。

[^32]: 如在1999年的电影[* Office Space *]（http://www.imdb.com/title/tt0151804/）中出名。

[^33]: 例如，使用promtool来验证您的Prometheus配置在语法上是正确的。

    **管理您的监控系统**

[^34]: 您可以通过公共库导出基本指标: 诸如[OpenCensus]（https://opencensus.io/）之类的检测框架，或[Istio]（https://istio.io/）之类的服务网格。

[^35]: 有关Borgmon的概念和结构，请参见* Site Reliability Engineering *的[Chapter 10]（http://bit.ly/2svQKYN）。

    **目的指标**

[^36]: 在这种情况下，通过日志进行监控很有吸引力，特别是因为生产更改相对很少。无论您使用日志还是指标，这些更改都应在仪表板上显示，以便调试生产问题时可以轻松访问。

[^37]: 请参阅[* https: //opencensus.io/*]（https://opencensus.io/），以获取提供此功能的一组库。

[^38]: 当您在很短的持续时间内过滤掉短暂的噪声时，Duration子句有时会很有用。但是，您仍然需要注意本节中列出的缺点。

[^39]: 如“站点可靠性工程”的[简介]（http://bit.ly/2xCtP3S）中所述，页面和故障单是促使人们采取行动的唯一有效方法。

[^40]: “测量内容: 第20页上的“使用SLI”建议一种SLI样式，该样式将根据对用户的影响进行缩放。

[^41]: 请参阅《站点可靠性工程》中的[“过载和故障”]（http://bit.ly/2J2gqr0）。

[^42]: 除临时更改警报参数外，这是解决持续中断的必要条件，并且在此期间不需要接收通知。

    **极端可用性目标**

[^43]: 这里列出的最主观的特征是是否可以自动化。通过自动完成工作来积累经验，您的观点将不断发展。一旦您习惯了“让机器人来完成工作”，那么一个看起来难以解决（或过于冒险）的问题空间将变得可行。

[^44]: 一些工程师不介意长时间工作-并非每个人的劳动容忍阈值都相同。从长远来看，琐事会导致职业停滞，同时促进职业倦怠引起的离职。一定程度的琐事是不可避免的，但我们建议在可行的情况下减少辛勤工作，以维护团队，服务和个人的健康。

    **什么是琐事？**

[^45]: 换句话说，如果一项服务及其九个依赖项各自具有99.99％的可用性，则该服务的总可用性将为0.9999 ^ 10 ^ = 99.9％。有关依赖关系如何影响服务可用性的更多信息，请参阅[“服务可用性计算”]（http://queue.acm.org/detail.cfm?id=3096459）。

[^46]: 当然，您将无法通过自助服务来处理一些一次性的情况（“您想让一个VM具有*多少*个RAM？”），但旨在涵盖大多数用例。将80--90％的请求转移到自助服务上仍然大大减少了工作量！

[^47]: 简而言之，从单个专用设备向具有公共接口的设备群过渡。请参阅“案例研究1: 有关对此类比的详细说明，请参见第107页的“通过自动化减少数据中心中的工作量”。

[^48]: 线卡是一个模块化组件，通常为网络提供多个接口。它与其他线卡和组件一起位于机箱的底板中。模块化网络交换机由一个机箱组成，该机箱包括一个背板，电源输入模块，控制卡模块以及一个或多个线卡。每个线卡都支持到计算机或其他线卡（在其他交换机中）的网络连接。与USB网络接口适配器一样，您可以在不关闭整个交换机电源的情况下更换任何线卡，前提是线卡已“排空”，这意味着已告知其他接口停止向其发送流量。

[^49]: 误码率测试: 在恢复服务之前检查链路是否不正常。

[^50]: 检查连接错误的端口。

[^51]: Piper是Google的内部版本控制系统。有关更多信息，请参阅Rachel Potvin和Josh Levenberg，“ Google为什么要在单个存储库中存储数十亿行代码”，* ACM通讯* 59，第1页。 7（2016）: 78--87，[* http: //bit.ly/2J4jgMi*]（http://bit.ly/2J4jgMi）。

[^52]: Google还具有可扩展的自助式Git托管，用于托管Piper中不存在的代码。

[^53]: [Beyond Corp]（https://cloud.google.com/beyondcorp/）是一项计划，旨在从传统的基于边界的安全性模型转变为基于密码身份的模型。当Google笔记本电脑连接到内部Google服务时，该服务通过识别笔记本电脑的加密证书，用户拥有的第二个因素（例如USB安全密钥），客户端设备的配置/状态和用户的凭证。

[^54]: x20是一个内部全局共享的，高度可用的文件系统，具有类似POSIX的文件系统语义。

[^55]: 如果您有兴趣了解更多信息，请阅读此软件复杂性趋势的最新[review]（https://arxiv.org/abs/1608.01533），或阅读Horst Zuse，*软件复杂性: 措施和方法*（柏林: Walter de Gruyter，1991年）。

[^56]: 尽管有一些示例，例如-[[“ AWS系统的自动化形式推理”]（http://bit.ly/2spRz6g）。

[^57]: 结果，SRE对于希望攻击复杂性作为产品技术债务代理的产品开发主管来说可能是一项有用的投资，但发现很难在现有团队的范围内证明这项工作的合理性。

    **简单化是端到端的，而SRE对此非常有用**

[^58]: 正如Dijkstra []]（http://bit.ly/2xwycxq）所说，“如果我们希望对代码行进行计数，则不应将它们视为“产生的行”，而应视为“花费的行”。”

[^59]: 为简单性项目保留一部分时间（例如10％）并不意味着团队就允许其他90％的团队引入复杂性开了绿灯。这只是意味着您将精力放在简化的特定目标上。

[^60]: 请注意，对于实际上没有实践DevOps的组织，此示例通常是一个危险信号，在这种情况下，更名不会解决更多的结构性问题。

[^61]: 一个“事件”被定义为一个“问题”，无论针对同一“问题”发出了多少警报。一班是12个小时。

[^62]: David Blank-Edelman（O'Reilly）的[* Seeking SRE *]（https://oreil.ly/2kIawNe）中有关于此主题的更多信息。

[^63]: Google的SRE团队在各个时区配对，以确保服务的连续性。

[^64]: 在这种情况下，“错误”是指由软件或配置错误引起的任何不良系统行为。代码中的逻辑错误，二进制文件的错误配置，不正确的容量计划，错误配置的负载平衡器或新发现的漏洞都是造成值班负载的“生产错误”的有效示例。

[^65]: 当三个或三个以上的人员处理一个事件时，启动一个协作文档很有用，该文档列出了工作原理，消除的原因以及有用的调试信息，例如错误日志和可疑图形。该文档会保留此信息，因此不会在对话中迷路。

[^66]: 克里帕·克里山（Kripa Krishan），“出乎意料的风雨”，* ACM通讯* 10，否。 9（2012），[* https: // ** queue.acm.org / detail.cfm？id = 2371516 *]（https://queue.acm.org/detail.cfm?id=2371516）。

    **将最佳实践付诸实践**

[^67]: 5元组包括以下内容: 源地址，目标地址，源端口，目标端口和传输协议类型。

[^68]: 有关SLO和SLA之间差异的说明，请参见Google Cloud Platform博客文章[“ SLO，SLI，SLA，哦，我的CRE生活课程”]（http://bit.ly/2LL02ch）。

[^69]: 有关此主题的更多信息，请参见第一本SRE书的[第22章]（http://bit.ly/2Hbpl3z）。

[^70]: 参见*《站点可靠性工程》 *，[第19章]（http://bit.ly/2LQ6TRQ）

[^71]: 有关容量规划中冗余的更多信息，请参见《站点可靠性工程》 *，[附录B]（http://bit.ly/2syqM76）。

    **自动缩放**

[^72]: Fay Chang等人，“大表: 一种用于结构化数据的分布式存储系统，” *《计算机系统上的ACM事务处理》（TOCS）* 26，第2号（2008），[* http: //bit.ly/2J22BZv*]（http://bit.ly/ 2J22BZv）。

[^73]: 本部分基于Rajagopal Ananthanarayanan等人的“光子: 连续数据流的容错和可伸缩联接”，在SIGMOD '13中: * 2013 ACM SIGMOD国际数据管理国际会议论文集*（纽约: ACM，2013年），[* http: //bit.ly/2Jse3Ns*]（http://bit.ly/2Jse3Ns）。

[^74]: 请参阅第12届国际扩展数据库技术会议的*会议记录中的Umeshwar Dayal等人的文章《商业智能的数据集成流程》: 数据库技术的进步*（纽约: ACM，2000），1-1-1。

    **管道应用**

[^75]: 有关将依赖关系纳入服务可靠性的更多详细信息，请参阅Ben Treynor等人的“服务可用性计算”，* ACM队列* 15，否。 2（2017），[* https: //queue.acm.org/detail.cfm？id = 3096459 *]（https://queue.acm.org/detail.cfm?id=3096459）。

[^76]: [Cloud Dataproc]（https://cloud.google.com/dataproc/）是用于运行Apache Spark和Apache Hadoop集群的完全托管的云服务。

[^77]: [Cloud Dataflow]（https://cloud.google.com/dataflow/）是一种完全托管的云服务，用于以流模式和批处理模式转换数据，并且具有相同的可靠性和表现力。

[^78]: [区域端点]（https://cloud.google.com/dataflow/docs/concepts/regional-endpoints）控制工作人员，并存储和处理Cloud Dataflow作业的元数据。

[^79]: 交付的事件是已交付到持久性存储并以事件交付系统的客户可以使用的方式公开的事件（例如，数据作业）。

[^80]: 产生的事件既是已传递的事件，也是当前流经事件传递系统的事件。

[^81]: 外部服务提供商保证SLA，并拥有自己的待命团队以确保产品满足这些SLA。

[^82]: Kim Vicente，《人为因素》（纽约: Routledge，2006），71--6。

[^83]: 虽然显然是夸张的，但[有关最差音量控制接口的Reddit线程]（http://bit.ly/2J6JA8F）可以洞悉回答同一问题“音量应为多少”的好坏机制之间的区别。 ？

[^84]: 全文: [* http: //www.dangoldstein.com/papers/DefaultsScience.pdf*]（http://www.dangoldstein.com/papers/DefaultsScience.pdf）。

[^85]: Jsonnet用于编译为Kubernetes YAML，为该并行提供了真实示例。请参阅[* http: //ksonnet.heptio.com/*]（http://ksonnet.heptio.com/）。

[^86]: 当组织执行向新技术的迁移，整合并购或专注于共享基础结构，但在其他方面具有不同的开发和系统管理实践时，这将非常有用。

[^87]: 有多种实用方法可以自动将新配置编译为原始数据。例如，如果将配置存储在版本控制系统中，则提交后挂钩可以简化此过程。可替代地，定期更新过程可以以一些延迟为代价来执行该操作。

    **配置机制**

[^88]: 尽管C ++不太可能用于配置，但是[clang-format]（http://bit.ly/2swrrG0）很好地证明了，甚至比大多数用于配置的语言更复杂的语言也可以完全自动格式化。

[^89]: 在非常大型的组织中，能够注释已弃用的广泛复用的配置也很有用。当有可用的替代产品时，自动重写工具可促进集中式更改，从而有助于避免遗留问题。

    **配置机制**

[^90]: 请注意，您可能可以编写软件将旧的配置语言转换为新的语言。但是，如果您的原始源语言是非标准语言或已损坏，则这不是可行的选择。

[^91]: 从计算生物学到视频游戏的领域都使用Jsonnet，但最热心的采用者来自Kubernetes社区。Box.com使用Jsonnet来描述在其基于Kubernetes的内部基础架构平台上运行的工作负载。Databricks和Bitnami也广泛使用该语言。

    **配置系统的关键属性和陷阱**

[^92]: YAML流是一个文件，其中包含许多由\“ \-\-\”分隔的YAML文档。

[^93]: YAML规范§6.9.2。

[^94]: 在YAML规范中，*对象*被称为*文档*。

    **集成现有应用程序: Kubernetes**

[^95]: 本章的作者是Jez Humble和David Farley的书的爱好者*连续交付: 通过构建，测试和部署自动化*发行可靠的软件（波士顿: 皮尔逊（Pearson），2011年）。

[^96]: 您在金丝雀上运行的总服务负载的比例应与金丝雀种群的大小成比例。

    **发布工程和金丝雀发布**

[^97]: 至少就可用性而言。显然，该分析未涵盖事件的影响，例如数据泄漏。

[^98]: 对于足够小的金丝雀，其中服务部分等于实际可用性和SLO之间的差，我们可以充满信心地直达金丝雀。这是我们对错误预算的使用。

[^99]: 正如英国统计学家乔治·博克斯（George Box）所说: “本质上，所有模型都是错误的，但有些模型是有用的。”George EP Box和Norman R. Draper，“经验模型构建和响应面”（纽约: John Wiley and Sons，1987年）。

    **金丝雀实现**

[^100]: 请参阅[* http: //bit.ly/2LgorFz*]（http://bit.ly/2LgorFz）上有关实际中断的讨论。

[^101]: 例如，考虑资源争用问题，例如数据库写冲突或在多线程应用程序中锁定。

[^102]: 失败的用户请求不一定有问题。用户请求可能会失败，因为用户请求了一些不合理的内容，例如访问不存在的URL。我们需要纪律严明，以区分此类错误和系统中的问题。

    **选择和评估指标**

[^103]: Kara A. Latorella，*调查中断: 对Flightdeck性能的影响*（弗吉尼亚州汉普顿: 兰里研究中心，1999年），[* https: //go.nasa.gov/2Jc50Nh*]（https://go.nasa.gov/2Jc50Nh）； NTSB，*飞机事故报告: NWA DC-9-82 *
    >
    > * N312RC，底特律都会区，1987年8月16日（编号NTSB / AAR-88 / 05）*（华盛顿特区: 全国交通
    
    安全局，1988年），[* http: //libraryonline.erau.edu/online-full-text/ntsb/aircraft-accident-reports/AAR88-05.pdf*]（http://libraryonline.erau.edu/在线全文/ntsb/aircraft-accident-reports/AAR88-05.pdf）。

[^104]: Emmanuelle Brun和Malgorzata Milczarek，*与职业安全与健康有关的新兴社会心理风险的专家预测*（西班牙毕尔巴鄂: 欧洲工作安全与卫生局，2007年），[* https: // ** osha.europa.eu / zh-CN / tools-and-publications / publications / reports / 7807118 *]（https://osha.europa.eu/en/tools-and-publications/publications/reports/7807118）； M. Melchior，I。Niedhammer，LF Berkman和M. Goldberg，“社会心理工作因素和社会关系是否对疾病缺席发挥独立影响？GAZEL队列的六年前瞻性研究”，《流行病学与社区健康杂志》 57，第4期（2003年）: 285--93，[* http: //jech.bmj.com/content/jech/57/4/285.full.pdf*]（http://jech.bmj.com/content/jech/57/4 /285.full.pdf）。

    **从负载到过载**

[^105]: 就上下文而言，根据估计，SRE每班需要至少再增加一天的故障单跟踪。

[^106]: 我们使用了基于Project Aristotle的Google程序: [* http: //bit.ly/2LPemR2*]（http://bit.ly/2LPemR2）。

[^107]: Kurt GI Wahlstedt和Christer Edling，“邮政分拣站的组织变革-它们对工作满意度，心身投诉和病假的影响”，《工作与压力》，第11期，第11页。 3（1997）: 279--91。

[^108]: 小罗伯特·卡拉塞克（Robert A. Karasek），“工作需求，工作决策自由度和精神紧张-对工作重新设计的影响”，《管理科学季刊》，第24期，第24页。 2（1979）: 285--308。

[^109]: 弗兰克·邦德（Frank W. Bond）和大卫·邦斯（David Bunce），“工作控制在减少压力的工作重组干预中发挥了作用”，《职业健康心理学杂志》 6，第6期。 4（2001）: 290--302； Toby D. Wall，Paul R. Jackson和Keith Davids，“操作员的工作设计和机器人系统性能: 偶然的田野研究，” *应用心理学杂志* 77，第3号（1992年）: 353--62。

[^110]: Brun和Malgorzata，*专家预测*。

    **缓解过载的策略**

[^111]: Google HR通过在发生这种转变时寻找新的机会来支持员工。

    **结束关系**

[^112]: 布鲁斯·塔克曼（Bruce W. Tuckman），“小组中的发展顺序”，《心理公报》 * 63，第1期。 6（1965）: 384--99。

[^113]: Shylaja Nukala和Vivek Rau，“为什么SRE文件很重要”，* ACM队列*（2018年5月至6月）: 即将出版。

[^114]: 伊丽莎白·库伯勒·罗斯（ElisabethKübler-Ross），*关于死亡和垂死: 垂死者必须教医生，护士，神职人员及其家属*（纽约: Scribner，1969）。

[^115]: 即使SLO中的数字不是严格依据证据的，也有必要对此进行记录，以使将来的读者可以理解这一事实，并做出适当的决定。他们可能会决定值得收集更多证据的投资。

    ** SLO文档示例**

[^116]: P0是错误的最高优先级: 所有人都在甲板上；放下其他所有东西，直到解决为止。
    >
    > **附录B: 错误预算政策示例**

[^117]: 在Google，季度计划是公开的，团队要对其计划负责。

    **错误预算策略示例**
