
> **附录A SLO文档示例**

本文介绍了示例游戏服务的SLO。

+ ----------------- + ----------------- +
| > **状态** | **已发布** |
+ ================================= +
| >作者|史蒂文·瑟古德|
+ ----------------- + ----------------- +
| >日期| 2018-02-19 |
+ ----------------- + ----------------- +
| >审稿人|大卫·弗格森|
+ ----------------- + ----------------- +
| >批准人|贝茜·拜尔|
+ ----------------- + ----------------- +
| >批准日期| 2018-02-20 |
+ ----------------- + ----------------- +
| >重新访问日期| 2019-02-01 |
+ ----------------- + ----------------- +

**服务概述**

*示例游戏服务*允许Android和iPhone用户彼此玩游戏。该应用程序在用户的手机上运行，并且移动通过REST API发送回* API *。*数据存储区*包含所有当前和先前游戏的状态。*得分管道*读取该表并生成今天，本周和所有时间的最新联赛表。排行榜结果可在应用程序中通过API获得，也可以在公共* HTTP服务器*上获得。

SLO使用四个星期的滚动窗口。

** SLO文档示例**

** SLI和SLO **

+ ---------------- + --------- + --------- +
| > **类别** | ** SLI ** | ** SLO ** |
+ ---------------- + --------- + --------- +

> ** API **

+ ------------------------------------------------- -------------------------------------------------- -------------------------------------------------- ---------- + --------------------------------------- -------------------------------------------------- -------------------------------------------------- ------- + --------------------------- +
|可用性|根据负载均衡器指标衡量的成功请求的比例。除500--599以外的任何HTTP状态均被视为成功。| 97％成功|
| | | |
| |没有5XX状态代码的\“ api \” http_request计数除以| |
| | | |
| |所有\“ api \” http_requests的计数| |
+ ================================================== ================================================== ================================================== ========= + ======================================== ================================================== ================================================== ======= + ========================= +
|延迟|根据负载均衡器指标测得的足够快的请求的比例。                                                        | 90％的请求\ <400毫秒|
| | | |
| | “足够快”定义为\ <400毫秒或\ <850毫秒。                                                                                       | 99％的请求\ <850毫秒|
| | | |
| |持续时间小于或等于|个“ api” http_requests的数量|
| | | |
| | \“ 0.4 \”秒除以| |
| | | |
| |所有\“ api \” http_requests的计数| |
| | | |
| |持续时间小于或等于|个“ api” http_requests的数量|
| | | |
| | \“ 0.85 \”秒除以| |
| | | |
| |所有\“ api \” http_requests的计数| |
+ ------------------------------------------------- -------------------------------------------------- -------------------------------------------------- ---------- + --------------------------------------- -------------------------------------------------- -------------------------------------------------- ------- + --------------------------- +
| ** HTTP服务器** | | |
+ ------------------------------------------------- -------------------------------------------------- -------------------------------------------------- ---------- + --------------------------------------- -------------------------------------------------- -------------------------------------------------- ------- + --------------------------- +
|可用性根据负载平衡器指标衡量的成功请求的比例。除500--599以外的任何HTTP状态均被视为成功。| 99％| |
+ ------------------------------------------------- -------------------------------------------------- -------------------------------------------------- ---------- + --------------------------------------- -------------------------------------------------- -------------------------------------------------- ------- + --------------------------- +

>没有5XX状态代码的\“ web \” http_request的计数除以
>
>所有“网络” http_requests的计数

延迟（Latency）根据负载平衡器指标测得的足够快的请求所占的比例。

>“足够快”定义为\ <200毫秒或\ <1,000毫秒。
>
>持续时间小于或等于“ \ web” http_request的数量
>
> \“ 0.2 \”秒除以
>
>所有“网络” http_requests的计数
>
>持续时间小于或等于“ \ web” http_request的数量
>
> \“ 1.0 \”秒除以所有\“ web \” http_requests的计数
>
> **附录A：SLO文档示例**

90％的请求\ <200毫秒

99％的请求\ <

1,000毫秒

+ ---------------------- + -------------------------- -------------------------------------------------- -------------------------------------------------- --------------------- + ---------------------------- -------------------------------------------------- --------------------------------------------- +
| **类别SLI ** | ** SLO ** | |
+ ================================================= ================================================== ================================================== ==================== + ============================= ================================================== ========================================== +
| > **得分管道** |从联赛表中读取的最近更新的记录的比例。                                                                  | 90％的读取使用前1分钟内写入的数据。99％的读取使用前10分钟内写入的数据。|
| > | | |
| >新鲜度| “最近”定义为1分钟内或10分钟内。使用来自API和HTTP服务器的指标：                                        | |
| | | |
| |新鲜度小于或等于1分钟的\“ api \”和\“ web \”的所有data_request的计数除以| |
| | | |
| |所有data_requests的计数| |
| | | |
| |新鲜度小于或等于10分钟的\“ api \”和\“ web \”的所有data_request的计数除以| |
| | | |
| |所有data_requests的计数| |
+ ---------------------- + -------------------------- -------------------------------------------------- -------------------------------------------------- --------------------- + ---------------------------- -------------------------------------------------- --------------------------------------------- +
| >正确性|正确性探测器向状态表中注入的记录所占的比例，导致从联盟表中读取正确的数据。|探测器注入的99.99999％的记录将导致正确的输出。                                                 |
| | | |
| |正确性探测器会注入已知正确结果的综合数据，并导出成功指标：                                           | |
| | | |
| |正确的所有data_request的计数除以| |
| | | |
| |所有data_requests的计数| |
+ ---------------------- + -------------------------- -------------------------------------------------- -------------------------------------------------- --------------------- + ---------------------------- -------------------------------------------------- --------------------------------------------- +
| >完整性|数据存储中100％游戏的处理时所占的小时数（不跳过任何记录）。                                    | 99％的管道运行覆盖了100％的数据。                                                                              |
| | | |
| |使用分数管道导出的指标：                                                                                                      | |
| | | |
| |处理100％记录的所有管道运行的计数除以| |
| | | |
| |所有管道运行的数量| |
+ ---------------------- + -------------------------- -------------------------------------------------- -------------------------------------------------- --------------------- + ---------------------------- -------------------------------------------------- --------------------------------------------- +

**理论**

可用性和延迟SLI基于2018年1月1日至2018年1月28日之间的测量。可用性SLO向下舍入到最接近的1％，而延迟SLO时序被舍入到最接近的50 ms。作者选择了所有其他数字，并验证了这些服务正在或高于这些级别运行。

尚未尝试验证这些数字是否与用户体验密切相关。[^115]

**错误预算**

每个目标都有一个单独的错误预算，定义为该目标的100％减去（-）目标。例如，如果在前四周中有1,000,000个请求发送到API服务器，则API可用性错误预算为1,000,000中的3％（100％-97％）：30,000个错误。

当我们的任何目标用尽错误预算时，我们将制定错误预算政策（请参阅附录B）。

**说明和警告**

-请求指标是在负载均衡器上测量的。此度量可能无法准确度量用户请求未到达负载均衡器的情况。

-我们仅将HTTP 5XX状态消息视为错误代码；其他一切都算成功。

-正确性探测器使用的测试数据包含大约200个测试，每1秒注入一次。我们的错误预算是每四周48个错误。

> **附录A：SLO文档示例**